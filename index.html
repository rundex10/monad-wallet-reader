<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monad Allocation Checker</title>
    <style>
        @font-face {
            font-family: 'CustomFont';
            src: url('noto.ttf') format('truetype');
        }

        body {
            font-family: 'CustomFont', Arial, sans-serif;
            background: url('bg.jpg') no-repeat center center fixed;
            background-size: cover;
            color: white;
            text-align: center;
            padding: 20px;
        }

        h1 {
            color: #e0b3ff;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        body, input, button {
            font-family: 'CustomFont', Arial, sans-serif;
        }

        .wallet-input {
    padding: 10px;
    border-radius: 20px;
    border: 1px solid #b366ff;
    width: 300px;
    outline: none;
    background: linear-gradient(135deg, #3b0066, #5e00a3);
    color: white;
    font-size: 16px;
}

.btn {
    padding: 10px 15px;
    border: 1px solid #b366ff;
    border-radius: 20px;
    background: linear-gradient(135deg, #0a0a0a, #141413);
    color: white;
    cursor: pointer;
    font-weight: bold;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
    transition: 0.3s;
    font-size: 16px;
}

        .btn:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #a32cc4, #5e00a3);
        }

        .card {
            background: rgba(91, 0, 133, 0.6);
            padding: 15px;
            margin: 20px auto;
            width: 300px;
            border-radius: 20px;
            border: 1px solid #b366ff;
            font-size: 18px;
        }

        .card-allocation {
           background: linear-gradient(135deg, #006400, #000000);
           border: 1px solid #00ff99;
           color: #ffffff;
        }

        .loading {
            display: inline-block;
            font-size: 20px;
        }

        .dot {
            display: inline-block;
            animation: wave 3s infinite;
        }

        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes wave {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-8px); }
        }

        .tip-message {
           position: fixed;
           bottom: 20px;
           left: 50%;
           transform: translateX(-50%);
           color: white;
           font-family: monospace;
           font-size: 14px;
           text-align: center;
       }

        .footer-left {
            position: fixed;
            bottom: 15px;
            left: 20px;
            font-size: 14px;
            color: white;
            background: rgba(0, 0, 0, 0.4);
            padding: 6px 10px;
            border-radius: 10px;
            border: 1px solid white;
            backdrop-filter: blur(5px);
        }

        .footer-right {
            position: fixed;
            bottom: 15px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 0, 0, 0.4);
            padding: 6px 10px;
            border-radius: 20px;
            border: 1px solid white;
            backdrop-filter: blur(5px);
        }

        .profile-thumb {
            width: 40px;
            height: 40px;
            border-radius: 50px;
            object-fit: cover;
            border: 1px solid white;
        }

        .footer-right a {
            color: #fff;
            text-decoration: none;
            font-weight: bold;
        }

        .footer-right a:hover {
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
    .footer-left, .footer-right, .tip-message {
        position: static;
        display: block;
        margin: 10px auto;
        text-align: center;
        background: none;
        border: none;
        backdrop-filter: none;
    }

    .footer-right {
        flex-direction: column;
        gap: 5px;
    }

    .profile-thumb {
        width: 30px;
        height: 30px;
    }

    h1 {
        font-size: 1.8rem;
    }

    .wallet-input, .btn, .card {
        width: 90%;
        font-size: 14px;
    }
        
    @media (max-width: 768px) {
        h1 {
            font-size: 1.8rem;
        }

        .wallet-input, .btn, .card {
            width: 90%;
            font-size: 14px;
        }

        .footer-left, .footer-right, .tip-message {
            position: static;
            margin: 10px auto;
            display: block;
            text-align: center;
            border: none;
            background: rgba(0,0,0,0.5);
        }

        .footer-right {
            flex-direction: column;
            gap: 5px;
            padding: 10px;
        }

        .profile-thumb {
            width: 30px;
            height: 30px;
        }
            }
    </style>
</head>
<body>
    <h1>ðŸ’œ Monad Allocation Checker (-,-)</h1>
    <input type="text" id="walletAddress" class="wallet-input" placeholder="0x.....">
    <button onclick="checkWallet()" class="btn">Begin</button>

    <div id="result" style="margin-top: 20px;"></div>

    <div class="footer-left">
      ðŸ’œ Built with love by Community
    </div>

    <div class="tip-message">
    Tip me some $MON :) : 0xb7b4d3dCFC024BF09caaE26aDd7B3a7B321A01a7
</div>

    <div class="footer-right">
      <img src="mrp.jpg" alt="Profile" class="profile-thumb">
      <span>â€¢ Follow my X : <a href="https://twitter.com/murphyejr" target="_blank">@murphyejr</a></span>
    </div>

    <script>
    const ALCHEMY_KEY = "P9QADugjmL2Ib2ivnLv_j";
    const BASE_URL = `https://monad-testnet.g.alchemy.com/v2/${ALCHEMY_KEY}`;

    function getExpectedMonAllocation(totalTx) {
        let min, max;

        if (totalTx <= 499) {
            max = 100; min = 1;
        } else if (totalTx <= 999) {
            max = 200; min = 100;
        } else if (totalTx <= 1999) {
            max = 300; min = 200;
        } else if (totalTx <= 4999) {
            max = 400; min = 300;
        } else if (totalTx <= 9999) {
            max = 500; min = 400;
        } else if (totalTx <= 49999) {
            max = 600; min = 500;
        } else if (totalTx <= 99999) {
            max = 700; min = 600;
        } else if (totalTx <= 499999) {
            max = 800; min = 700;
        } else if (totalTx <= 999999) {
            max = 900; min = 800;
        } else {
            max = 1000; min = 900;
        }

        let randomAlloc = (Math.random() * (max - min) + min).toFixed(2);
        return `${randomAlloc} $MON`;
    }

    async function checkWallet() {
        const address = document.getElementById("walletAddress").value.trim();
        const resultDiv = document.getElementById("result");

        if (!address) {
            alert("Address form cannot be empty");
            return;
        }

        // Cek jika ada hasil sebelumnya di localStorage
        const savedData = localStorage.getItem(`alloc_${address}`);
        if (savedData) {
            const parsed = JSON.parse(savedData);
            showResult(parsed.balanceEth, parsed.txCount, parsed.allocation);
            return;
        }

        resultDiv.innerHTML = `<div class="loading"><span class="dot">.</span><span class="dot">.</span><span class="dot">.</span></div>`;

        try {
            const balanceRes = await fetch(BASE_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    jsonrpc: "2.0",
                    id: 1,
                    method: "eth_getBalance",
                    params: [address, "latest"]
                })
            });
            const balanceData = await balanceRes.json();
            const balanceEth = parseInt(balanceData.result, 16) / 1e18;

            const txRes = await fetch(BASE_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    jsonrpc: "2.0",
                    id: 1,
                    method: "eth_getTransactionCount",
                    params: [address, "latest"]
                })
            });
            const txData = await txRes.json();
            const txCount = parseInt(txData.result, 16);

            let allocation;
            if (!txData.result || isNaN(txCount) || txCount === 0) {
                allocation = "0 $MON";
            } else {
                allocation = getExpectedMonAllocation(txCount);
            }

            // Simpan hasil ke localStorage
            localStorage.setItem(`alloc_${address}`, JSON.stringify({
                balanceEth,
                txCount,
                allocation
            }));

            showResult(balanceEth, txCount, allocation);

        } catch (err) {
            resultDiv.innerHTML = `<div style="color:red;">Failed to fetch</div>`;
            console.error(err);
        }
    }

    function showResult(balanceEth, txCount, allocation) {
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = "";
        setTimeout(() => {
            resultDiv.innerHTML += `<div class="card">Total Balance: <b>${isNaN(balanceEth) ? '0.000000' : balanceEth.toFixed(6)} $MON</b></div>`;
            setTimeout(() => {
                resultDiv.innerHTML += `<div class="card">Total Transactions: <b>${txCount} txn</b></div>`;
                setTimeout(() => {
                    resultDiv.innerHTML += `<div class="card card-allocation">Expected Allocation: <b>${allocation}</b></div>`;
                }, 500);
            }, 500);
        }, 500);
    }
</script>
</body>
</html>
